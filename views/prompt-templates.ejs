<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title || '提示词管理 - 微信群聊智能分析平台' %></title>
    <link rel="stylesheet" href="/css/style.css?v=5.7">
</head>
<body>
    <!-- 导航栏 -->
    <nav class="main-nav">
        <div class="nav-container">
            <div class="nav-brand">
                <h2>微信群聊智能分析平台</h2>
            </div>
            <ul class="nav-menu">
                <li><a href="/tasks" class="nav-link">任务管理</a></li>
                <li><a href="/reports" class="nav-link">报告中心</a></li>
                <li><a href="/prompt-templates" class="nav-link active">提示词管理</a></li>
                <li><a href="/settings" class="nav-link">系统设置</a></li>
            </ul>
            <div class="nav-actions">
                <button class="theme-toggle" aria-label="切换主题">🌙</button>
            </div>
        </div>
    </nav>

    <div class="page-container">
        <div class="page-content">
            <!-- 紧凑的头部操作区 -->
            <div class="content-header-compact">
                <div class="header-left">
                    <h2 class="page-title">📝 提示词模板</h2>
                    <span class="template-count" id="templateCount">0 个模板</span>
                </div>
                <div class="header-actions">
                    <button type="button" id="newTemplateBtn" class="btn-primary-compact">
                        <span>➕</span> 新建模板
                    </button>
                </div>
            </div>

            <div class="content-main">
                <!-- 紧凑的模板网格 -->
                <div class="templates-grid" id="templatesList">
                    <!-- 模板列表由JS动态渲染 -->
                    <div class="loading-compact">正在加载模板...</div>
                </div>

                <div class="empty-state-compact" id="empty-state" style="display: none;">
                    <div class="empty-icon">📝</div>
                    <h3>还没有模板</h3>
                    <p>创建你的第一个提示词模板</p>
                    <button type="button" class="btn-primary-compact" onclick="document.getElementById('newTemplateBtn').click()">立即创建</button>
                </div>


            </div>
        </div>
    </div>

    <!-- 模板编辑/新建弹窗 -->
    <div id="templateModal" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h3 id="modalTitle">新建提示词模板</h3>
                <button type="button" class="modal-close" onclick="closeTemplateModal()">✕</button>
            </div>
            <div class="modal-body">
                <form id="template-form">
                    <div class="form-group">
                        <label for="templateName" class="form-label required">模板名称</label>
                        <input type="text" id="templateName" name="templateName" class="form-control" placeholder="如：群聊活跃度分析" required>
                    </div>

                    <div class="form-group">
                        <label for="templateDescription" class="form-label">模板描述</label>
                        <input type="text" id="templateDescription" name="templateDescription" class="form-control" placeholder="简要说明此模板的用途和适用场景">
                    </div>

                    <div class="form-group">
                        <label for="templateCategory" class="form-label">模板分类</label>
                        <select id="templateCategory" name="templateCategory" class="form-control">
                            <option value="analysis">通用分析</option>
                            <option value="topic">话题分析</option>
                            <option value="behavior">用户行为</option>
                            <option value="business">商务分析</option>
                            <option value="sentiment">情感分析</option>
                            <option value="custom">自定义</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="templateSystemPrompt" class="form-label required">系统提示词</label>
                        <textarea id="templateSystemPrompt" name="templateSystemPrompt" class="form-control" rows="8" 
                            placeholder="请输入AI分析的系统提示词，定义分析任务、要求和输出格式..." required></textarea>
                        <div class="form-text">
                            系统提示词将作为AI分析的基础指令，建议包含：分析目标、关注要点、输出格式等
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="templateIsDefault" name="templateIsDefault">
                            <span class="checkmark"></span>
                            设为默认模板
                        </label>
                        <div class="form-text">
                            默认模板会在创建新任务时自动选择
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="saveTemplateBtn" class="btn-primary-compact">
                    <span>💾</span> 保存模板
                </button>
                <button type="button" class="btn-secondary-compact" onclick="closeTemplateModal()">
                    <span>❌</span> 取消
                </button>
            </div>
            <div id="templateFeedback" class="feedback"></div>
        </div>
    </div>

    <script src="/js/theme.js"></script>
    <script src="/js/scroll-to-top.js"></script>
    <script src="/js/ui-manager.js"></script>
    <script src="/js/navigation.js"></script>
    <script src="/js/prompt-templates.js"></script>
</body>
</html> 